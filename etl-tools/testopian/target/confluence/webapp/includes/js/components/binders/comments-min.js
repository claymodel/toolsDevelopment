AJS.Confluence.Binder.comments=function(){var c=AJS.$;if(c(window).data("comments-bound")){AJS.log("Currently, this comment binding can only be done once per page");return}var b=function(j){var h=function(l,k){return{animate:function(m){l.style.height=AJS.animation.interpolate(m,48,24,k)+"px";l.style.width=l.style.height;l.style.marginLeft=AJS.animation.interpolate(m,0,12,k)+"px"},onFinish:function(){l.style.height="";l.style.width="";l.style.marginLeft=""}}};var f=function(l,k){return{start:1,end:0,reverse:k,animate:function(m){l.style.opacity=m;l.style.filter="alpha(opacity="+(m*100)+")"},onFinish:function(){l.style.opacity="";l.style.filter="alpha(opacity="+(k?100:0)+")"}}};var i=function(l,k){if(!k){l.originalHeight=jQuery(l).height()}return{start:l.originalHeight||50,end:0,reverse:k,animate:function(m){l.style.height=m+"px"},onFinish:function(){l.style.height=""}}};var e=jQuery(j).find(".comment-body")[0];var g=j.className.indexOf("collapsed")>=0;return AJS.animation.combine([h(jQuery(j).parent().find(".comment-user-logo img, .comment-user-logo .replacement")[0],g),f(e,g),f(jQuery(j).find(".excerpt")[0],!g),i(e,g),{onFinish:function(){if(g){jQuery(j).removeClass("collapsed")}else{jQuery(j).addClass("collapsed")}}}])};var d=function(){var e=this;c(e).unbind("click");AJS.animation.add(b(c(e).parent()[0]));AJS.animation.add({onFinish:function(){c(e).click(d)}});AJS.animation.start()};if(AJS.isIE6){c(".logo.anonymous").each(function(){var e=document.createElement("div");e.className="replacement";AJS.applyPngFilter(e,this.src);c(this).replaceWith(e)});c(".comment-actions .comment-permalink a").each(function(){c(this).addClass("filtered");var f=c(this).css("background-image").replace(/^url\(\"?|\"?\)$/g,"");var e=f.replace("light","dark");AJS.applyPngFilter(this,f);this.style.cursor="pointer";this.style.background="none";c(this).hover(function(){AJS.applyPngFilter(this,e)},function(){AJS.applyPngFilter(this,f)})})}c("#comments-section .comment:odd").addClass("odd");c(".comment-action-remove a").click(function(){if(confirm(AJS.params.deleteCommentConfirmMessage)){this.href=this.href+"&confirm=yes";return true}return false});var a=function(e){c("#page-comments").toggleClass("hidden",!e);c(".comments-show-hide").toggleClass("comments-showing",e);c(".icon.comments-show-hide").toggleClass("icon-section-closed",!e);c(".icon.comments-show-hide").toggleClass("icon-section-opened",e)};c(".comments-show-hide").click(function(){a(!c(this).hasClass("comments-showing"));return false})};