jQuery.fn.shortenUntil=function(d){var b=jQuery;var c=0;while(!d()&&c<this.length){var a=b(this[c]).text();if(a=="\u2026"){c++;continue}b(this[c]).text(a.replace(/[^\u2026]\u2026?$/,"\u2026"))}return this};jQuery.fn.renderBreadcrumbs=function(j){var f=jQuery,d=this,h=[],g=0,l=j.length-1;var a=j[g];var b=a.url.indexOf("~")>=0?"personalspacedesc":"spacedesc";h.push(AJS.renderTemplate("movePageBreadcrumb",a.title,a.url,(g==l?"last content-type-"+b:""),a.title));while(g++<l){var k=j[g];h.push(AJS.renderTemplate("movePageBreadcrumb",k.title,k.url,(g==l?"last content-type-"+j.type:""),k.title))}var e=function(){return d.width()<d.closest(".breadcrumbs-container").width()};this.html(h.join(""));var c=f("li a span",this);c.each(function(i){if(i!=0&&i!=l){f(this).shortenUntil(e)}});f(c.get(0)).shortenUntil(e);f(c.get(l)).shortenUntil(e);return this};AJS.toInit(function(d){var b=d("#confluence-context-path").attr("content");function a(e){for(var f=1;f<e.length;f++){if(e[f].title==AJS.params.pageTitle){return false}}return true}if(!AJS.MoveDialog){AJS.MoveDialog={}}var c={};AJS.MoveDialog.getBreadcrumbs=function(f,h,e){var g=f.userName?f.userName:(f.pageId?(f.pageId+":"+f.fileName):(f.spaceKey+":"+f.title+":"+f.postingDay+":"+f.fileName));if(g in c){h(c[g],"success");return}d.ajax({type:"GET",dataType:"json",data:f,url:b+"/pages/breadcrumb.action",error:e||function(){},success:function(j,k){if(!j||!j.breadcrumbs){e(j,k);return}var i=d.makeArray(j.breadcrumbs);while(i[0]&&(/dashboard.action$/.test(i[0].url)||(j.type!="userinfo"&&/peopledirectory.action$/.test(i[0].url)))){i.shift()}i.type=j.type;c[g]=i;h(i,k)}})};AJS.MoveDialog.Breadcrumbs=function(g){var e=0;function f(k,j,i){g.renderBreadcrumbs(j);var h=k!=AJS.params.spaceKey||a(j);if(h){i.clearErrors();d(i.moveButton).attr("disabled","")}else{i.error(AJS.params.movePageDialogInvalidLocation);d("li:last-child",g).addClass("warning")}}return{update:function(i,h){g.html(AJS.renderTemplate("movePageBreadcrumbLoading"));var j=e+=1;var k=function(){if(j!=e){AJS.log("Breadcrumb response for ");AJS.log(i);AJS.log(" is stale, ignoring.");return true}return false};AJS.MoveDialog.getBreadcrumbs(i,function(l,m){if(k()){return}if(m!="success"||!l){g.html(AJS.renderTemplate("movePageBreadcrumbError",m));return}f(i.spaceKey,l,h)},function(l){if(k()){return}g.html(AJS.renderTemplate("movePageBreadcrumbError"));if(l.status==404){h.error(AJS.params.movePageDialogLocationNotFound)}})}}}});